<!DOCTYPE html>
    <head>
        <link href="https://fonts.googleapis.com/css2?family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet"> 
        <link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet"> 
        <style type="text/css">
            * {
                font-family: "Ubuntu";
                color: #aaaaaa;
            } textarea, pre, label, nani, nani * {
                font-family: "Ubuntu Mono";
            } h1, h2, h3, h4, h5, h6 {
                color: #00ffff;
            } body {
                background-color: #112222;
            } a {
                color: #aaffff;
            } #val, #val2 {
                border-radius: 5px;
                border: 2px solid #00ffff;
                margin: 8px auto;
                background-color: #223333;
                padding: 8px;
                width: 64%;
                min-width: 64%;
                max-width: 64%;
                height: 55px;
                max-height: 55px;
                min-height: 55px;
            } #boxes {
                columns: 2;
                width: 80%;
                margin: 8px auto;
            } input[type="checkbox"][disabled] {
                opacity: 50%;
            } #val2 {
                width: 30%;
                min-width: 30%;
                max-width: 30%;
                overflow: hidden;
                display: inline-block;
                top: 4px;
                position: relative;
                border: 2px solid #00ff00;
                background-color: #223322;
            }
        </style>
    </head>
    <body>
        <h1>#] Discord permissions converter</h1>
        <h3>#] Checkboxes to integer</h3>
        <a href="int.html">Convert to integer</a> [check boxes to int]
        <div style="width: 80%; margin: 8px auto;">
            <textarea id="val" title="Input value">0</textarea>
            <div id="val2" title="True value">
                <nani><b>DEC:</b> ${trueint}</nani><br>
                <nani><b>HEX:</b> 0x0</nani><br>
                <nani><b>BIN:</b> <span style="font-size: x-small">0b0</span></nani>
            </div>
        </div>
        <div id="boxes"></div>
        <script type="text/javascript">
            function redo(evt) {
                val = document.getElementById("val").value
                var int = Number.parseInt(val);
                if(evt.key == "ArrowUp")
                    int += 1
                else if(evt.key == "ArrowDown")
                    int -= 1
                for(var key of Object.keys(perms))
                    document.getElementById(key).checked = (int & perms[key]);
                recalc();
                if(val.startsWith("0x"))
                    int = int.toString(16);
                else if(val.startsWith("0b"))
                    int = int.toString(2);
                else if(val.startsWith("0o"))
                    int = int.toString(8);
                document.getElementById("val").value = int + "";
                document.getElementById("val").innerHTML = int + "";
            }
            function recalc() {
                var int = 0;
                var trueint = 0
                if(document.getElementById("ADMINISTRATOR").checked) {
                    trueint = 8;
                    for(var key of Object.keys(perms)) {
                        elem = document.getElementById(key);
                        if(elem.checked)
                            int |= perms[key];
                        if(key == "ADMINISTRATOR")
                            continue
                        elem.disabled = true;
                    }
                } else {
                    for(var key of Object.keys(perms)) {
                        elem = document.getElementById(key);
                        elem.disabled = false;
                        if(elem.checked)
                            trueint |= perms[key];
                    }
                    int = trueint;
                }
                document.getElementById("val2").innerHTML = `
<nani><b>DEC:</b> ${trueint}</nani><br>
<nani><b>HEX:</b> 0x${trueint.toString(16)}</nani><br>
<nani><b>BIN:</b> <span style="font-size: x-small">0b${trueint.toString(2)}</span></nani>`;
                return int;
            }
            fetch("perms.json").then((resp) => {
                resp.text().then((text) => {
                    eval(text);
                    for(var key of Object.keys(perms)) {
                        document.getElementById("boxes").innerHTML += 
`<input type="checkbox" id="${key}" name="${key}" value="${perms[key]}" onclick="recalc()"><label for="${key}"> ${key}</label><br>`;
                    }
                })
            });
            document.getElementById("val").onkeyup = redo;
        </script>
    </body>
</html>
